# Отчёт по ИДЗ №2 (Вариант №3)

**Хачукаев Рамзан Русланович, БПИ225**

## Условие задачи
### Задача о Винни-Пухе – 2 или неправильные пчелы. 

N пчел живет в улье. Каждая пчела может собирать мед или сторожить
улей (N > 3). Пчела не покинет улей, если кроме нее в нем нет других пчел. Каждая пчела приносит за раз одну порцию меда. Всего в улей может войти тридцать порций меда. Вини-Пух спит пока меда в улье меньше половины, но как только его становится достаточно, он просыпается и пытается достать весь мед из улья. Если в улье находится меньше трех пчел, Вини-Пух забирает мед, убегает, съедает мед и снова засыпает. Если пчел три или больше, то они кусают Вини-Пуха, он убегает, лечит укус некоторое время, а затем снова бежит за медом. Создать приложение, моделирующее поведение пчел и медведя. Осуществить балансировку, обеспечивающую циклическое освобождение улья от меда.
Медведя и каждую из пчел представить отдельными процессами.

## Описание сценария
В данной задаче моделируется поведение пчел и Винни-Пуха, где каждая сущность представлена отдельным процессом:
- **Пчелы** собирают мед и могут сторожить улей.
- **Винни-Пух** пытается воровать мед.
- При достижении критического количества меда (половина улья) Винни-Пух активизируется и пытается взять мед.
- Если в улье менее трех пчел, мед удачно крадется, если три и более — пчелы отпугивают медведя.
- Как минимум одна пчела всегда сторожит мёд.

## Реализация
### Общие аспекты
- Программа использует множество процессов, каждый из которых выполняет роль либо Винни-Пуха, либо одной из пчел.
- Связь между процессами осуществляется через разделяемую память и семафоры.

### Использование именованных семафоров (4–5 баллов)
- В реализации с именованными семафорами (`named.c`) используются POSIX семафоры для координации доступа к разделяемой памяти.
- Пчелы и Винни-Пух координируют доступ к улью, используя эти семафоры для управления мутексом и условиями ожидания/сигналов.
- Запуск: 
```bash 
  ./named <число пчёл>
  ```
- Результат работы:
```bash 
  ./named 3
  ```
```
Число пчёл должно быть больше трех.
```
```bash
./named 4
```
```
Пчела добавила мёд. Всего мёда: 1, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 2, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 3, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 4, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 5, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 6, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 7, сборщиков: 3, охранников: 1
Пчела принесла мёд и решила охранять улей. Всего мёда: 7, сборщиков: 2, охранников: 2
Пчела добавила мёд. Всего мёда: 8, сборщиков: 2, охранников: 2
Пчела принесла мёд и решила охранять улей. Всего мёда: 8, сборщиков: 1, охранников: 3
Пчела добавила мёд. Всего мёда: 9, сборщиков: 1, охранников: 3
Пчела принесла мёд и решила охранять улей. Всего мёда: 9, сборщиков: 0, охранников: 4
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 9, сборщиков: 1, охранников: 3
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 9, сборщиков: 2, охранников: 2
Пчела добавила мёд. Всего мёда: 10, сборщиков: 2, охранников: 2
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 10, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 11, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 12, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 13, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 14, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 15, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 16, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 17, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 18, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 19, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 20, сборщиков: 3, охранников: 1
Винни-Пух забирает весь мёд!
Пчела добавила мёд. Всего мёда: 1, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 2, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 3, сборщиков: 3, охранников: 1
^C
```

### Использование неименованных семафоров (6–7 баллов)
- В реализации с неименованными семафорами (`unnamed.c`) семафоры расположены в разделяемой памяти, что позволяет процессам синхронизировать свои действия без использования глобального пространства имен.
- Аналогично, доступ к улью координируется через эти семафоры, позволяя безопасно обновлять состояние улья.
- Запуск:
- ```bash 
  ./unnamed <число пчёл>
  ```
- Результат работы:
```bash 
  ./unnamed 3
  ```
```
Число пчёл должно быть больше трех.
```
```bash
./unnamed 4
```
```
Пчела добавила мёд. Всего мёда: 1, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 2, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 3, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 4, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 5, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 6, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 8, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 9, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 7, сборщиков: 3, охранников: 1
Пчела принесла мёд и решила охранять улей. Всего мёда: 9, сборщиков: 2, охранников: 2
Пчела принесла мёд и решила охранять улей. Всего мёда: 9, сборщиков: 1, охранников: 3
Пчела принесла мёд и решила охранять улей. Всего мёда: 9, сборщиков: 0, охранников: 4
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 9, сборщиков: 2, охранников: 2
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 9, сборщиков: 1, охранников: 3
Пчела добавила мёд. Всего мёда: 10, сборщиков: 3, охранников: 1
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 9, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 11, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 12, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 14, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 13, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 15, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 16, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 17, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 18, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 19, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 20, сборщиков: 3, охранников: 1
Винни-Пух забирает весь мёд!
Пчела добавила мёд. Всего мёда: 1, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 2, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 3, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 4, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 5, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 6, сборщиков: 3, охранников: 1
Пчела принесла мёд и решила охранять улей. Всего мёда: 6, сборщиков: 2, охранников: 2
Пчела принесла мёд и решила охранять улей. Всего мёда: 6, сборщиков: 1, охранников: 3
Пчела принесла мёд и решила охранять улей. Всего мёда: 6, сборщиков: 0, охранников: 4
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 6, сборщиков: 1, охранников: 3
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 6, сборщиков: 2, охранников: 2
Пчела устала охранять улей и полетела собирать мёд. Всего мёда: 6, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 7, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 8, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 9, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 10, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 11, сборщиков: 3, охранников: 1
Пчела добавила мёд. Всего мёда: 12, сборщиков: 3, охранников: 1
^C
```

## Завершение работы программы
- Программа должна корректно завершаться на сигнал прерывания с клавиатуры, при этом должны быть корректно удалены все семафоры и освобождена разделяемая память.

## Результаты работы программы
Программа успешно демонстрирует заданное взаимодействие между Винни-Пухом и пчелами, корректно обрабатывает сценарии как с именованными, так и с неименованными семафорами. В процессе работы программы ведется логирование ключевых событий, что позволяет отслеживать ход выполнения задачи.

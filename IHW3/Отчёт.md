# Отчёт по ИДЗ №3 (Вариант №3)

**Хачукаев Рамзан Русланович, БПИ225**

## Условие задачи
### Задача о Винни-Пухе – 2 или неправильные пчелы. 

N пчел живет в улье. Каждая пчела может собирать мед или сторожить улей (N > 3). Пчела не покинет улей, если кроме нее в нем нет других пчел. Каждая пчела приносит за раз одну порцию меда. Всего в улей может войти тридцать порций меда. Винни-Пух спит пока меда в улье меньше половины, но как только его становится достаточно, он просыпается и пытается достать весь мед из улья. Если в улье находится меньше трех пчел, Винни-Пух забирает мед, убегает, съедает мед и снова засыпает. Если пчел три или больше, то они кусают Винни-Пуха, он убегает, лечит укус некоторое время, а затем снова бежит за медом.

Создать клиент-серверное приложение, моделирующее поведение пчел и медведя.
Медведя и улей с пчелами представить в виде отдельных клиентов. Сервер обрабатывает поступающие от них сообщения и передает их клиентам в соответствии с установленными выше правилами.

## Описание сценария
В данной задаче моделируется поведение пчёл и Винни-Пуха, где каждая сущность представлена отдельным процессом:
- **Пчелы** собирают мед и могут сторожить улей.
- **Винни-Пух** пытается воровать мед.
- При достижении критического количества меда (половина улья) Винни-Пух активизируется и пытается взять мед.
- Если в улье менее трех пчел, мед удачно крадется, если три и более — пчелы отпугивают медведя.
- Как минимум одна пчела всегда сторожит мёд.

## Реализация для оценки 4–5 баллов
### Архитектура приложения
Приложение состоит из сервера и двух типов клиентов: пчёл и Винни-Пуха. Сервер отвечает за хранение состояния улья и обработку запросов от клиентов. Пчёлы отправляют серверу команды на сбор мёда или охрану улья. Винни-Пух периодически пытается украсть мёд из улья.

### Компоненты
1. **Сервер:** Хранит состояние улья, количество мёда, количество пчёл-сборщиков и пчёл-охранников, а также состояние Винни-Пуха (спит или пытается украсть мёд). Обрабатывает запросы от клиентов.
2. **Клиент-пчела:** Периодически отправляет серверу команды на сбор мёда или охрану улья в зависимости от вероятности.
3. **Клиент Винни-Пух:** Периодически отправляет серверу команду на попытку украсть мёд.

### Взаимодействие компонентов
- Клиент-пчела отправляет запрос на сбор мёда или охрану улья.
- Сервер обрабатывает запрос и обновляет состояние улья.
- Клиент Винни-Пух отправляет запрос на попытку украсть мёд.
- Сервер обрабатывает запрос и либо сообщает об успешной краже мёда, либо о том, что Винни-Пуха укусили пчёлы.

### Запуск программы
Для запуска программы необходимо указать IP-адрес и порт для сервера, а также интервал времени для клиентов.
```sh 
# Запуск сервера
./server <порт> <количество пчёл>

# Запуск клиента-пчел (с интервалом, например, 2 секунды)
./bee_client <IP_сервера> <порт> 2

# Запуск клиента Винни-Пуха (с интервалом, например, 5 секунд)
./winnie_pooh_client <IP_сервера> <порт> 5

```
- Результат работы:
```sh
```

## Реализация для оценки 6–7 баллов
#### Функциональность клиента для мониторинга

- Подключается к серверу.
- Периодически запрашивает состояние системы (количество мёда, количество пчёл-сборщиков, количество пчёл-охранников и состояние медведя).
- Отображает полученную информацию в консоли, позволяя следить за изменениями в системе.

```sh
# Запуск сервера
./server <порт> <количество пчёл>

# Запуск клиента-пчел (с интервалом, например, 2 секунды)
./bee_client <IP_сервера> <порт> 2

# Запуск клиента Винни-Пуха (с интервалом, например, 5 секунд)
./winnie_pooh_client <IP_сервера> <порт> 5

# Запуск монитор-клиента (с интервалом, например, 3 секунды)
./monitor_client <IP_сервера> <порт> 3

```
- Результат работы:
```sh
```

## Реализация для оценки 8 баллов

### Поддержка множества клиентов

Приложение было модифицировано для поддержки множества клиентов. Теперь клиенты могут подключаться и отключаться в любое время без нарушения работы сервера. Это позволяет одновременно работать нескольким клиентам, отображающим информацию о состоянии системы.

```sh 
# Запуск сервера
./server <порт> <количество пчёл>

# Запуск клиента-пчел (с интервалом, например, 2 секунды)
./bee_client <IP_сервера> <порт> 2

# Запуск клиента Винни-Пуха (с интервалом, например, 5 секунд)
./winnie_pooh_client <IP_сервера> <порт> 5

# Запуск монитор-клиента (с интервалом, например, 3 секунды)
./monitor_client <IP_сервера> <порт> 3

# Запуск второго монитор-клиента (с интервалом, например, 3 секунды)
./monitor_client <IP_сервера> <порт> 3
```
- Результат работы:
```sh
```

## Реализация для оценки 9 баллов

### Отключение и повторное подключение клиентов

```sh 
# Запуск сервера
./server <порт> <количество пчёл>

# Запуск клиента-пчел (с интервалом, например, 2 секунды)
./bee_client <IP_сервера> <порт> 2

# Запуск клиента Винни-Пуха (с интервалом, например, 5 секунд)
./winnie_pooh_client <IP_сервера> <порт> 5

# Запуск монитор-клиента (с интервалом, например, 3 секунды)
./monitor_client <IP_сервера> <порт> 3

```
- Результат работы:
```sh
```

Приложение было доработано таким образом, чтобы клиенты могли отключаться и подключаться повторно, сохраняя при этом работоспособность сервера. Клиенты могут быть перезапущены, и сервер продолжит корректно обрабатывать их команды.

## Реализация для оценки 10 баллов

### Корректное завершение работы сервера

```sh 
# Запуск сервера
./server <порт> <количество пчёл>

# Запуск клиента-пчел (с интервалом, например, 2 секунды)
./bee_client <IP_сервера> <порт> 2

# Запуск клиента Винни-Пуха (с интервалом, например, 5 секунд)
./winnie_pooh_client <IP_сервера> <порт> 5

# Запуск монитор-клиента (с интервалом, например, 3 секунды)
./monitor_client <IP_сервера> <порт> 3

```
- Результат работы:
```sh
```

Программа была расширена, чтобы при завершении работы сервера все подключенные клиенты корректно завершали свою работу. Это обеспечивает безопасное завершение всех процессов, предотвращая потерю данных и состояние гонки.

## Результаты работы программы

Программа успешно выполняет все заявленные функции:
- Пчёлы корректно переключаются между сбором мёда и охраной улья.
- Медведь корректно крадёт мёд или получает укусы от пчёл в зависимости от состояния улья.
- Клиент для мониторинга отображает текущее состояние системы в реальном времени.
- Все клиенты корректно взаимодействуют с сервером, что позволяет моделировать и наблюдать за поведением системы в целом.
- Поддерживается работа множества клиентов одновременно.
- Клиенты могут отключаться и повторно подключаться без нарушения работы сервера.
- Сервер и клиенты корректно завершают работу при остановке сервера.